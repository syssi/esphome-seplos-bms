substitutions:
  name: seplos-bms-tx
  device_description: "Fake Seplos BMS protocol version 0x20"
  tx_pin: GPIO4
  rx_pin: GPIO5

esphome:
  name: ${name}
  min_version: 2024.6.0

esp8266:
  board: d1_mini

wifi:
  ssid: !secret wifi_ssid
  password: !secret wifi_password

ota:
  platform: esphome

logger:
  level: DEBUG

api:
  reboot_timeout: 0s

uart:
  id: uart_0
  baud_rate: 9600
  tx_pin: ${tx_pin}
  rx_pin: ${rx_pin}
  debug:
    direction: BOTH
    dummy_receiver: true
    after:
      delimiter: "\r"
    sequence:
      - lambda: UARTDebug::log_string(direction, bytes);

interval:
  - interval: 8s
    then:
      # Responses to "~20004642E00200FD37\r"
      - uart.write: "~2000460010960001100CD70CE90CF40CD60CEF0CE50CE10CDC0CE90CF00CE80CEF0CEA0CDA0CDE0CD8060BA60BA00B970BA60BA50BA2FD5C14A0344E0A426803134650004603E8149F0000000000000000DC6C\r"
      - delay: 1s
      - uart.write: "~2000460010960001100CD80CE80CF40CD70CEE0CE50CE10CDD0CE90CF00CE80CEF0CEB0CDA0CDE0CD9060BA60BA00B970BA60BA50BA2FD7214A0344A0A426803134650004603E8149F0000000000000000DC7C\r"
      - delay: 1s
      - uart.write: "~2000460010960001100CD70CE80CF40CD70CEF0CE50CE10CDC0CE80CF00CE80CEF0CEA0CDA0CDE0CD9060BA60BA00B970BA60BA60BA2FD7C14A034460A426803134650004603E8149F0000000000000000DC78\r"
      - delay: 1s
      - uart.write: "~2000460010960001100CD70CE80CF30CD60CEE0CE50CE00CDC0CE80CEF0CE70CEE0CE90CD90CDD0CD8060BA60BA00B970BA60BA60BA2FD60149F34420A426803124650004603E8149F0000000000000000DC86\r"
      - delay: 1s
      - uart.write: "~2000460010960001100CD70CE80CF40CD60CEE0CE50CE00CDC0CE80CF00CE70CEE0CE90CD90CDD0CD8060BA60BA00B970BA60BA70BA2FD4F149F343F0A426803124650004603E8149E0000000000000000DC73\r"
      - delay: 1s
      - uart.write: "~2000460010960001100CD70CE70CF30CD60CEE0CE40CE00CDB0CE80CEF0CE70CEE0CEA0CD90CDD0CD8060BA60BA00B970BA60BA70BA2FD49149F343B0A426803124650004603E8149E0000000000000000DC6B\r"
      - delay: 1s

      # Response to "~200046510000FDAE\r"
      - uart.write: "~20004600C040313130312D5350313520020743414E50726F746F636F6C3A536F666172202020F046\r"

      # Response to "~20004644E00200FD35\r"
      - uart.write: "~20004600A06000010F000000000000000000000000000000060000000000000000140000000000000300000200000000000000000002EB74\r"

      # Response to "~200046930000FDA8\r"
      - uart.write: "~200046040000FDB0\r"

      # Response to "~200046920000FDA9\r"
      - uart.write: "~200046040000FDB0\r"

      # Response to "~200046510000FDAE\r"
      - uart.write: "~20004600C040313130312D5A4832362002062020202020202020202020202020202020202020F116\r"

      # Response to "~2000464F0000FD9A\r"
      - uart.write: "~200046000000FDB4\r"

      # Response to "~200046470000FDA9\r"
      - uart.write: "~200046008152013C0DAC0D480B540BB80E420D480A280B540D1605DC151813BA10FE1194156313BA0F3C10FE189C17D40CD10C9F0ABF0ADD0D030C9F0A470AAB0CD10C9F0A470AC90D350C9F0A150AAB0AAB0B0F0CD10C9F0AAB0AC90D350CD10A470AAB0E2F0DFD0E930DFD2710251CD6FCD7C42AF8D5089E5807D0271013881B321E1E140A0F0A0A1E3C0505010A0A1EF0180F0560506409000D0008FFFFFF3FBF978F0F313130312D5A48323620B257\r"

      # Response to "~20004644E00200FD35\r"
      - uart.write: "~20004600A06000010F000000000000000000000000000000060000000000000000140000000000000300000200000000000000000002EB74\r"

#      # Responses to "~20004642E00200FD37\r"
#      - uart.write: "~20004600509200010F0D080D050D080D0B0D0B0D0B0D070D070D080D070D0A0D040D0C0D0B0D05060C3C0C370C3B0C360C380C230000138C25510A271003BB2710010203E813900000000000000000DEEC\r"
#      - delay: 1s
#      - uart.write: "~20004600509200010F0D080D050D080D0B0D0A0D0B0D070D070D070D070D0A0D040D0C0D0B0D05060C3B0C370C3A0C340C370C230000138C25510A271003BB2710010203E813900000000000000000DEF3\r"
#      - delay: 1s
#      - uart.write: "~20004600509200010F0D080D050D080D0B0D0B0D0B0D070D070D080D070D0A0D040D0C0D0B0D05060C3D0C370C3A0C360C390C230000138C25510A271003BB2710010203E813900000000000000000DEEB\r"
#      - delay: 1s
#      - uart.write: "~20004600509200010F0D070D050D080D0B0D0A0D0B0D070D070D070D070D0A0D040D0C0D0B0D05060C3C0C370C3B0C360C380C230000138C25510A271003BB2710010203E813900000000000000000DEEF\r"
#      - delay: 1s
#      - uart.write: "~20004600509200010F0D070D050D080D0B0D0A0D0B0D060D070D070D070D090D040D0C0D0B0D05060C3B0C370C3B0C350C370C230000138C25510A271003BB2710010203E813900000000000000000DEFB\r"
#      - delay: 1s
#      - uart.write: "~20004600509200010F0D070D050D080D0B0D0A0D0B0D060D070D080D070D090D040D0C0D0A0D04060C3B0C370C3A0C350C370C230000138B25510A271003BB2710010203E813900000000000000000DEFE\r"
#      - delay: 1s
#      - uart.write: "~20004600509200010F0D070D050D080D0B0D0A0D0B0D060D070D080D070D090D040D0C0D0A0D05060C3C0C370C3A0C350C380C230000138C25510A271003BB2710010203E813900000000000000000DEFA\r"
#      - delay: 1s
#      - uart.write: "~20004600509200010F0D080D050D080D0B0D0A0D0B0D070D070D080D070D0A0D040D0C0D0B0D05060C3D0C370C3A0C360C390C230000138C25510A271003BB2710010203E813900000000000000000DEEC\r"
